
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
	<head>
		<meta charset="UTF-8">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
		<link rel="stylesheet" href="/css/main.css">
		<title>Carte-O-Culture</title>
	</head>
	<body>
		<div class="title title-page" id="logo">
			<span id="txt-left">Carte -</span>
			<img id="logo-img" src="/img/loupe.jpg" alt="logo_loupe" width="75" height="75">
			<span id="txt-right">- Culture</span>

		</div>
		<div class="box box-search">
			<!--filtre les points-->
			<form id="filter" action="post">
				<select name="selector-book" id="selector-book">
				</select>
				<label><input type="checkbox" id="box_livre_1" onclick="toggle_marker(this,1)" />Manon Lescaut</label>
				<label><input type="checkbox" id="box_livre_2" onclick="toggle_marker(this,2)" />Fantine</label> 
				<!--<textarea name="" id="" cols="30" rows="1">choissisez un livre</textarea>-->
				<button type="submit">Envoyer</button>
			</form>
		</div>
		<div class="box box-horizontal">
			<!--
			<div class="box box-info">
				<div class="box box-vertical">
					<table>
						<tr>
							<td>Ville 1</td>
							<td>Livre 1</td>
						</tr>
						<tr>
							<td>Ville 2</td>
							<td>Livre 2</td>
						</tr>
						<tr>
							<td>Ville 3</td>
							<td>Livre 3</td>
						</tr>
					</table>
				</div>
			</div>
			-->

			<!--Élément Div pour afficher la carte-->
			<div class="box box-map" id="map"></div>
			<script>
				var map;
				var markers = [];

				// Map functions
				function create_map(div_name) {
					var mapProp= {
						center:new google.maps.LatLng(51.508742,-0.120850),
						zoom:5,
					};
					map = new google.maps.Map(document.getElementById("map"),mapProp);
					return map;
				}

				// Marker functions
				function add_marker(i, x, y, map) {
					var LatLng = {lat: x, lng: y};
					markers[i] = new google.maps.Marker({position: LatLng});
					markers[i].setMap(map);
					markers[i].setVisible(true);
				}

				function initMap() {
					create_map("map");
					var livres = [
						{"name":"Lescaut" , "auteur":"Doe"  , "lieux":[0,0]},
						{"name":"Fantine" , "auteur":"Smith", "lieux":[0,0]},
						{"name":"Germinal", "auteur":"Jones", "lieux":[0,0]}
					];
					var x = 0;
					var y = 0;
					const sel = document.getElementById("selector-book");			
					for (let i = 0; i < livres.length; i++) {
						x = Math.random()*10+40;
						y = Math.random()*6+2;
						add_marker(i,x, y, map);

						const opt = document.createElement("option");
						opt.value = "1";
						opt.id = "box_livre_"+i;
						opt.text = livres[i]["name"];
						sel.add(opt, null);
					}					
				}

				function toggle_marker(box,i) {
					if (box.checked) {
						markers[i].setVisible(true);
					} else {
						markers[i].setVisible(false);
					}
				}

			</script>
			<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAoBbN_BhqAdAJ1T4t3f09861MMwjBbJ6Q&callback=initMap" defer></script>
		</div>
		<footer>
			Projet DevOps Master 2022			
		</footer>
	</body>
</html>